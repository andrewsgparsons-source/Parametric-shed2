// FILE: docs/index.html
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Parametric Shed</title>

  <style>
    html, body { height: 100%; margin: 0; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: #f6f7f8; color: #111; }
    #topbar {
      position: fixed; left: 0; right: 0; top: 0;
      height: 44px;
      display: flex; align-items: center; gap: 10px;
      padding: 0 12px;
      background: #ffffff;
      border-bottom: 1px solid rgba(0,0,0,0.08);
      z-index: 50;
      box-sizing: border-box;
    }
    #topbar .spacer { flex: 1; }
    #viewSelect { height: 28px; }

    #controls {
      position: fixed;
      left: 0;
      top: 44px;
      bottom: 0;
      width: 360px;
      overflow: auto;
      background: #ffffff;
      border-right: 1px solid rgba(0,0,0,0.08);
      z-index: 40;
      box-sizing: border-box;
      padding: 12px;
    }

    #controls form { display: block; }
    fieldset { border: 1px solid rgba(0,0,0,0.14); border-radius: 8px; padding: 10px; margin: 0 0 12px 0; }
    legend { padding: 0 6px; font-weight: 600; }
    label { display: block; font-size: 12px; margin: 8px 0 4px 0; }
    input[type="number"], input[type="text"], select {
      width: 100%;
      box-sizing: border-box;
      height: 30px;
      padding: 4px 8px;
      border: 1px solid rgba(0,0,0,0.18);
      border-radius: 6px;
      background: #fff;
    }
    .row2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .row3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
    .row4 { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px; }
    button {
      height: 30px;
      border: 1px solid rgba(0,0,0,0.18);
      border-radius: 6px;
      background: #f3f4f6;
      cursor: pointer;
    }
    button:hover { background: #e9eaee; }
    .hint { font-size: 12px; color: rgba(0,0,0,0.62); margin: 8px 0 0 0; }

    #renderCanvas {
      position: fixed;
      left: 360px;
      top: 44px;
      right: 0;
      bottom: 0;
      width: auto;
      height: auto;
      display: block;
      outline: none;
      background: #eef0f2;
      z-index: 1;
    }

    #ui-layer { position: fixed; left: 360px; top: 44px; right: 0; bottom: 0; pointer-events: none; z-index: 2; }
    #statusOverlay {
      position: absolute;
      left: 10px;
      top: 10px;
      white-space: pre;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12px;
      line-height: 1.2;
      padding: 8px 10px;
      background: rgba(255,255,255,0.85);
      border: 1px solid rgba(0,0,0,0.12);
      border-radius: 8px;
      pointer-events: none;
      max-width: 520px;
    }

    /* BOM pages */
    #bomPage, #wallsBomPage {
      display: none;
      padding: 64px 16px 24px 16px;
      box-sizing: border-box;
      max-width: 1100px;
      margin: 0 auto;
    }
    .schedule-section { background: #fff; border: 1px solid rgba(0,0,0,0.08); border-radius: 10px; padding: 12px; margin: 0 0 12px 0; }
    table { width: 100%; border-collapse: collapse; background: #fff; }
    th, td { border: 1px solid rgba(0,0,0,0.10); padding: 6px 8px; font-size: 13px; }
    th { background: #f3f4f6; text-align: left; }
    td.highlight { font-weight: 700; }

    /* Instances UI rows */
    #instancesFieldset .instancesRow { display: grid; gap: 8px; margin-top: 8px; }
    #instancesFieldset .instancesRow.r1 { grid-template-columns: 1fr 110px; }
    #instancesFieldset .instancesRow.r2 { grid-template-columns: 1fr 110px; }
    #instancesFieldset .instancesRow.r3 { grid-template-columns: 1fr 1fr; }

    /* Ensure controls only appear in 3D view (views.js sets body[data-view]) */
    body[data-view="base"] #controls,
    body[data-view="walls"] #controls,
    body[data-view="base"] #topbar,
    body[data-view="walls"] #topbar,
    body[data-view="base"] #renderCanvas,
    body[data-view="walls"] #renderCanvas,
    body[data-view="base"] #ui-layer,
    body[data-view="walls"] #ui-layer { display: none !important; }
  </style>

  <script src="https://cdn.babylonjs.com/babylon.js"></script>
</head>

<body>
  <div id="topbar" aria-hidden="false">
    <strong>Views</strong>
    <select id="viewSelect" aria-label="View">
      <option value="3d">3D Scene</option>
      <option value="walls">Walls Cutting List</option>
      <option value="base">Base Cutting List</option>
    </select>
    <div class="spacer"></div>
    <label style="display:flex;align-items:center;gap:8px;margin:0;font-size:12px;">
      Units
      <select id="unitsSelect" aria-label="Units" style="width:120px;height:28px;">
        <option value="mm">mm</option>
        <option value="both">mm + inches</option>
      </select>
    </label>
    <button id="exportCsvBtn" type="button">Export CSV</button>
    <button id="printBtn" type="button">Print</button>
  </div>

  <aside id="controls" aria-hidden="false">
    <form id="controlPanel">
      <fieldset>
        <legend>Visibility</legend>
        <label><input type="checkbox" id="vBase" checked /> Base</label>
        <label><input type="checkbox" id="vFrame" checked /> Frame</label>
        <label><input type="checkbox" id="vIns" checked /> Insulation</label>
        <label><input type="checkbox" id="vDeck" checked /> Decking</label>
        <label><input type="checkbox" id="vWalls" checked /> Walls</label>

        <div class="row2" style="margin-top:8px;">
          <label><input type="checkbox" id="vWallFront" checked /> Front</label>
          <label><input type="checkbox" id="vWallBack" checked /> Back</label>
          <label><input type="checkbox" id="vWallLeft" checked /> Left</label>
          <label><input type="checkbox" id="vWallRight" checked /> Right</label>
        </div>
      </fieldset>

      <fieldset>
        <legend>Dimensions</legend>
        <label for="dimMode">Mode</label>
        <select id="dimMode">
          <option value="base">base</option>
          <option value="frame">frame</option>
          <option value="roof">roof</option>
        </select>
        <div class="row2">
          <div>
            <label for="wInput">W (mm)</label>
            <input id="wInput" type="number" min="1" step="10" value="3000" />
          </div>
          <div>
            <label for="dInput">D (mm)</label>
            <input id="dInput" type="number" min="1" step="10" value="4000" />
          </div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Roof</legend>
        <label for="roofStyle">Roof style</label>
        <select id="roofStyle">
          <option value="apex">Apex (gabled)</option>
          <option value="pent">Pent (single pitch)</option>
          <option value="hipped">Hipped</option>
        </select>

        <label for="roofOverUniform">Overhang uniform (mm)</label>
        <input id="roofOverUniform" type="number" min="0" step="10" value="0" />

        <div class="row2">
          <div>
            <label for="roofOverFront">Front (mm)</label>
            <input id="roofOverFront" type="number" step="10" />
          </div>
          <div>
            <label for="roofOverBack">Back (mm)</label>
            <input id="roofOverBack" type="number" step="10" />
          </div>
        </div>
        <div class="row2">
          <div>
            <label for="roofOverLeft">Left (mm)</label>
            <input id="roofOverLeft" type="number" step="10" />
          </div>
          <div>
            <label for="roofOverRight">Right (mm)</label>
            <input id="roofOverRight" type="number" step="10" />
          </div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Walls</legend>
        <label for="wallsVariant">Variant</label>
        <select id="wallsVariant">
          <option value="insulated">insulated</option>
          <option value="basic">basic</option>
        </select>

        <label for="wallSection">Stud / Plate section</label>
        <select id="wallSection">
          <option value="50x100">50x100</option>
          <option value="50x75">50x75</option>
        </select>

        <label for="wallHeight">Wall height (mm)</label>
        <input id="wallHeight" type="number" min="100" step="10" value="2400" />

        <fieldset style="margin-top:10px;">
          <legend>Doors</legend>
          <button id="addDoorBtn" type="button">Add Door</button>
          <button id="removeAllDoorsBtn" type="button" style="margin-left:8px;">Remove All Doors</button>
          <div id="doorsList" style="margin-top:8px;"></div>
        </fieldset>

        <fieldset style="margin-top:10px;">
          <legend>Windows</legend>
          <button id="addWindowBtn" type="button">Add Window</button>
          <button id="removeAllWindowsBtn" type="button" style="margin-left:8px;">Remove All Windows</button>
          <div id="windowsList" style="margin-top:8px;"></div>
        </fieldset>
      </fieldset>

      <fieldset id="instancesFieldset">
        <legend>Instances</legend>

        <div class="instancesRow r1">
          <select id="instanceSelect"></select>
          <button id="saveInstanceBtn" type="button">Save</button>
        </div>

        <div class="instancesRow r2">
          <input id="instanceNameInput" type="text" placeholder="New name..." />
          <button id="saveAsInstanceBtn" type="button">Save As</button>
        </div>

        <div class="instancesRow r3">
          <button id="loadInstanceBtn" type="button">Load</button>
          <button id="deleteInstanceBtn" type="button">Delete</button>
        </div>

        <p class="hint" id="instancesHint">Saved locally in this browser.</p>
      </fieldset>
    </form>
  </aside>

  <canvas id="renderCanvas" tabindex="0" aria-hidden="false"></canvas>

  <div id="ui-layer">
    <div id="statusOverlay">status...</div>
  </div>

  <main id="bomPage" aria-hidden="true">
    <h1>Base Cutting List</h1>

    <section class="schedule-section">
      <h4>Timber Frame</h4>
      <table>
        <thead><tr><th>Item</th><th>Qty</th><th>Length</th><th>Notes</th></tr></thead>
        <tbody id="timberTableBody"></tbody>
      </table>
      <div id="timberTotals" class="hint"></div>
    </section>

    <section class="schedule-section">
      <h4>OSB Decking — Standard Sheets</h4>
      <table>
        <thead><tr><th>Item</th><th>Qty</th><th>Size</th><th>Notes</th></tr></thead>
        <tbody id="osbStdBody"></tbody>
      </table>
      <div id="osbStdTotals" class="hint"></div>
    </section>

    <section class="schedule-section">
      <h4>OSB Decking — Rip/Trim Cuts</h4>
      <table>
        <thead><tr><th>Item</th><th>Qty</th><th>Size</th><th>Notes</th></tr></thead>
        <tbody id="osbRipBody"></tbody>
      </table>
      <div id="osbRipTotals" class="hint"></div>
      <div id="osbSummary" class="hint"></div>
    </section>

    <section class="schedule-section">
      <h4>PIR Insulation — Rip Cuts</h4>
      <table>
        <thead><tr><th>Item</th><th>Qty</th><th>Size</th><th>Notes</th></tr></thead>
        <tbody id="pirRipBody"></tbody>
      </table>
      <div id="pirSummary" class="hint"></div>
    </section>

    <section class="schedule-section">
      <h4>Plastic Grid Tiles</h4>
      <table>
        <thead><tr><th>Item</th><th>Qty</th><th>Size</th><th>Notes</th></tr></thead>
        <tbody id="gridBody"></tbody>
      </table>
    </section>
  </main>

  <main id="wallsBomPage" aria-hidden="true">
    <h1>Walls Cutting List</h1>
    <section class="schedule-section">
      <h4>Walls BOM</h4>
      <table>
        <thead>
          <tr>
            <th>Item</th>
            <th>Qty</th>
            <th>Length (mm)</th>
            <th>Width (mm)</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody id="bomTable"></tbody>
      </table>
    </section>
  </main>

  <script type="module">
    import { initViews } from "./src/views.js";
    import "./src/index.js";
    try { initViews(); } catch (e) {}
  </script>
</body>
</html>
