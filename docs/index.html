<!-- FILE: docs/index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Parametric Shed</title>

  <style>
    html, body { height: 100%; margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    #topbar { position: sticky; top: 0; z-index: 10; display: flex; align-items: center; gap: 12px; padding: 10px 12px; border-bottom: 1px solid #ddd; background: #fff; }
    #app { display: grid; grid-template-columns: 320px 1fr; height: calc(100% - 52px); }
    #controls { border-right: 1px solid #ddd; overflow: auto; padding: 12px; background: #fafafa; }
    #controlPanel { display: flex; flex-direction: column; gap: 14px; }
    #main { position: relative; overflow: hidden; }
    #renderCanvas { width: 100%; height: 100%; display: block; outline: none; }
    #ui-layer { position: absolute; inset: 0; pointer-events: none; }
    #statusOverlay { position: absolute; left: 10px; bottom: 10px; padding: 8px 10px; background: rgba(255,255,255,0.9); border: 1px solid #ddd; border-radius: 6px; white-space: pre; font-size: 12px; pointer-events: none; }

    .page { display: none; padding: 18px; overflow: auto; height: 100%; box-sizing: border-box; }
    .page h2 { margin: 0 0 10px; }
    .schedule-section { margin: 14px 0 18px; }
    .schedule-section h4 { margin: 0 0 8px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ddd; padding: 6px 8px; text-align: left; vertical-align: top; }
    th { background: #f3f3f3; }
    .row3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
    .row4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
    .hint { font-size: 12px; color: #666; }
    label { display: flex; flex-direction: column; gap: 6px; font-size: 12px; }
    input, select, button { font: inherit; }
    button { cursor: pointer; }
    .doorTop, .windowTop { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
    .doorActions, .windowActions { display: flex; gap: 8px; align-items: center; }
    .doorMsg, .windowMsg { display: none; white-space: pre-wrap; font-size: 12px; color: #b00020; margin-top: 6px; }
    .doorMsg.show, .windowMsg.show { display: block; }
    .snapBtn { display: none; }
    .snapBtn.show { display: inline-block; }
  </style>

  <script src="https://cdn.babylonjs.com/babylon.js"></script>
</head>

<body>
  <div id="topbar">
    <label style="flex-direction:row;align-items:center;gap:8px;">
      <span style="font-size:12px;">Pages</span>
      <select id="viewSelect">
        <option value="3d">3D Scene</option>
        <option value="walls">Walls Cutting List</option>
        <option value="base">Base Cutting List</option>
        <option value="roof">Roof Cutting List</option>
      </select>
    </label>
  </div>

  <div id="app">
    <aside id="controls" aria-hidden="false">
      <div id="controlPanel">
        <section>
          <h3 style="margin:0 0 8px;">Dimensions</h3>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
            <label>Mode
              <select id="dimMode">
                <option value="base">base</option>
                <option value="frame">frame</option>
                <option value="roof">roof</option>
              </select>
            </label>
            <label>Roof Style
              <select id="roofStyle">
                <option value="apex">Apex (gabled)</option>
                <option value="pent">Pent (single pitch)</option>
                <option value="hipped">Hipped</option>
              </select>
            </label>
            <label>Width (mm)
              <input id="wInput" type="number" min="1" step="10" />
            </label>
            <label>Depth (mm)
              <input id="dInput" type="number" min="1" step="10" />
            </label>
          </div>
        </section>

        <section>
          <h3 style="margin:0 0 8px;">Roof Overhang (mm)</h3>
          <div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:8px;">
            <label>Uniform
              <input id="roofOverUniform" type="number" min="0" step="1" />
            </label>
            <label>Front
              <input id="roofOverFront" type="number" min="0" step="1" />
            </label>
            <label>Back
              <input id="roofOverBack" type="number" min="0" step="1" />
            </label>
            <label>Left
              <input id="roofOverLeft" type="number" min="0" step="1" />
            </label>
            <label>Right
              <input id="roofOverRight" type="number" min="0" step="1" />
            </label>
          </div>
        </section>

        <section>
          <h3 style="margin:0 0 8px;">Visibility</h3>
          <div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:8px;">
            <label><span>Base</span><input id="vBase" type="checkbox" /></label>
            <label><span>Frame</span><input id="vFrame" type="checkbox" /></label>
            <label><span>Insulation</span><input id="vIns" type="checkbox" /></label>
            <label><span>Deck</span><input id="vDeck" type="checkbox" /></label>
            <label><span>Walls</span><input id="vWalls" type="checkbox" /></label>
          </div>

          <div style="margin-top:10px;display:grid;grid-template-columns:repeat(2, 1fr);gap:8px;">
            <label><span>Wall Front</span><input id="vWallFront" type="checkbox" /></label>
            <label><span>Wall Back</span><input id="vWallBack" type="checkbox" /></label>
            <label><span>Wall Left</span><input id="vWallLeft" type="checkbox" /></label>
            <label><span>Wall Right</span><input id="vWallRight" type="checkbox" /></label>
          </div>
        </section>

        <section>
          <h3 style="margin:0 0 8px;">Walls</h3>
          <div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:8px;">
            <label>Variant
              <select id="wallsVariant">
                <option value="insulated">insulated</option>
                <option value="basic">basic</option>
              </select>
            </label>
            <label>Section
              <select id="wallSection">
                <option value="50x100">50x100</option>
                <option value="50x75">50x75</option>
              </select>
            </label>
            <label>Height (mm)
              <input id="wallHeight" type="number" min="100" step="10" />
            </label>
          </div>
        </section>

        <section>
          <h3 style="margin:0 0 8px;">Doors</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px;">
            <button id="addDoorBtn" type="button">Add Door</button>
            <button id="removeAllDoorsBtn" type="button">Remove All Doors</button>
          </div>
          <div id="doorsList"></div>
        </section>

        <section>
          <h3 style="margin:0 0 8px;">Windows</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px;">
            <button id="addWindowBtn" type="button">Add Window</button>
            <button id="removeAllWindowsBtn" type="button">Remove All Windows</button>
          </div>
          <div id="windowsList"></div>
        </section>

        <section>
          <h3 style="margin:0 0 8px;">Instances</h3>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;align-items:end;">
            <label>Saved
              <select id="instanceSelect"></select>
            </label>
            <div style="display:flex;gap:8px;flex-wrap:wrap;">
              <button id="saveInstanceBtn" type="button">Save</button>
              <button id="loadInstanceBtn" type="button">Load</button>
            </div>

            <label>Name
              <input id="instanceNameInput" type="text" />
            </label>
            <div style="display:flex;gap:8px;flex-wrap:wrap;">
              <button id="saveAsInstanceBtn" type="button">Save As</button>
              <button id="deleteInstanceBtn" type="button">Delete</button>
            </div>
          </div>
          <div id="instancesHint" class="hint" style="margin-top:8px;"></div>
        </section>
      </div>
    </aside>

    <main id="main">
      <canvas id="renderCanvas"></canvas>
      <div id="ui-layer" aria-hidden="true"></div>
      <pre id="statusOverlay">status...</pre>

      <div id="wallsBomPage" class="page" aria-hidden="true">
        <h2>Walls Cutting List</h2>
        <div class="schedule-section">
          <h4>Walls — Items</h4>
          <table>
            <thead>
              <tr>
                <th>Item</th>
                <th>Qty</th>
                <th>L (mm)</th>
                <th>W (mm)</th>
                <th>D (mm)</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody id="bomTable"></tbody>
          </table>
        </div>
      </div>

      <div id="bomPage" class="page" aria-hidden="true">
        <h2>Base Cutting List</h2>

        <div class="schedule-section">
          <h4>Timber Frame</h4>
          <table>
            <thead>
              <tr><th>Item</th><th>Qty</th><th>Length</th><th>Notes</th></tr>
            </thead>
            <tbody id="timberTableBody"></tbody>
          </table>
          <div id="timberTotals" class="hint"></div>
        </div>

        <div class="schedule-section">
          <h4>OSB Decking — Standard Sheets</h4>
          <table>
            <thead>
              <tr><th>Item</th><th>Qty</th><th>Size</th><th>Notes</th></tr>
            </thead>
            <tbody id="osbStdBody"></tbody>
          </table>
          <div id="osbStdTotals" class="hint"></div>
        </div>

        <div class="schedule-section">
          <h4>OSB Decking — Rip/Trim Cuts</h4>
          <table>
            <thead>
              <tr><th>Item</th><th>Qty</th><th>Size</th><th>Notes</th></tr>
            </thead>
            <tbody id="osbRipBody"></tbody>
          </table>
          <div id="osbRipTotals" class="hint"></div>
          <div id="osbSummary" class="hint"></div>
        </div>

        <div class="schedule-section">
          <h4>PIR Insulation — Rip Cuts</h4>
          <table>
            <thead>
              <tr><th>Item</th><th>Qty</th><th>Size</th><th>Notes</th></tr>
            </thead>
            <tbody id="pirRipBody"></tbody>
          </table>
          <div id="pirSummary" class="hint"></div>
        </div>

        <div class="schedule-section">
          <h4>Plastic Grid Tiles</h4>
          <table>
            <thead>
              <tr><th>Item</th><th>Qty</th><th>Size</th><th>Notes</th></tr>
            </thead>
            <tbody id="gridBody"></tbody>
          </table>
        </div>

        <div class="schedule-section">
          <h4>Export / Print</h4>
          <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;">
            <button id="exportCsvBtn" type="button">Export CSV</button>
            <button id="printBtn" type="button">Print</button>
            <label style="width:200px;">Units
              <select id="unitsSelect">
                <option value="mm">mm</option>
                <option value="both">both</option>
              </select>
            </label>
          </div>
        </div>
      </div>

      <div id="roofBomPage" class="page" aria-hidden="true">
        <h2>Roof Cutting List</h2>
        <div class="schedule-section">
          <h4>Roof — Items</h4>
          <table>
            <thead>
              <tr>
                <th>Item</th>
                <th>Qty</th>
                <th>L (mm)</th>
                <th>W (mm)</th>
                <th>D (mm)</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody id="roofBomTable">
              <tr>
                <td colspan="6">(Roof cutting list not yet generated)</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </main>
  </div>

  <script type="module">
    import { initViews } from "./src/views.js";
    import "./src/index.js";
    initViews();
  </script>
</body>
</html>
